

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>base</title>
    <link rel="stylesheet" href="./base.css">
</head>
<body>
     <div id="parent">
        <div>
            <img src="./workplace.png" alt="" id="img1">
            <h1>Untitled Base</h1>
            <button id="btn">data</button>
            <button id="btn">Automatics</button>
            <button id="btn">Interfaces</button>

        </div>
       
        <div>
            <button id="btn">Help</button>
            <button id="btn">Share</button>
            <img src="./bell.png" alt="" id="img1">
        </div>
    </div> 

    <!-- ==============================parent1====================== -->
  
  <div id="parent1">
    <div id="parent2">
 
        <h2> Getting started</h2> <br>
        <h3>Import your work</h3>
       
        <p>Get started with Airtable right where you left off, with one of the following tools:</p>

        <div id="par2">
            <p>Google Sheets</p>
            <p>Paste</p>
    
    
        </div>
    
        <div id="par3">
            <p>Excel</p>
            <p>CSV / Other</p>
            
    
        </div>

        <div id="par4">
            <h4>Check out our templates</h4><br>
             <p>Looking for a head start? Our recommended templates will help build your base quickly.</p>
             <input type="text" placeholder="Find another template">
        </div>
        <div id="par5">
            <button>Project Tracker</button><br>
             <button>Content Calendar</button>
             <p>Need help? Check out our helpful resources. -> </p>
        </div>
     
        
    </div>

  

    <div id="parent3">
        <div id="child">
          <input type="text" placeholder="name"id="name">
         
          <input type="text" placeholder="title" id="title">
          <input type="text" placeholder="description" id="description">
      
          <input type="text" placeholder="Assign" id="assign">
          <!-- <input type="submit" id="submit"> -->
          <button type="submit" id="add1">ADD</button>

            <!-- <div>
       
                
                
                <input type="text"placeholder="name" id="name">
                <input type="text"placeholder="name">
                <input type="text"placeholder="name">
                <input type="text"placeholder="name">



            </div>
            <div>
       
              
                <input type="text" placeholder="Notes">
                <input type="text" placeholder="Notes">
                <input type="text" placeholder="Notes">
                <input type="text" placeholder="Notes">

            </div>
            <div>
            
               
                <input type="text" placeholder="Assign">
                <input type="text" placeholder="Assign">
                <input type="text" placeholder="Assign">
                <input type="text" placeholder="Assign"> 

            </div>
            <div>

              
                 <input type="text" placeholder="Status">
                <input type="text" placeholder="Status">
                <input type="text" placeholder="Status">
                <input type="text" placeholder="Status">

            </div>
            <div>
       
              onclick="onAdd()"
            </div> -->
     

            
           
           
       
         
     
        </div>
        <div class="containerbox">
            <h1  id="alltask"style="color: black;font-size: 20px;text-align: center;">All the Task</h1>
            <div id="items">
       



       
            </div>
        </div>
     
      
        
    </div> 




  </div>
    
</body>
</html>

    <script>


async function fetchData() {
            try {
                let res = await fetch(`https://cute-puce-bluefish-garb.cyclic.app/post/add`);
                console.log(res);
                res = await res.json();
                console.log(res);
                displayData(res);
            } catch (err) {
                console.log(err);
            }
        }


const addButton = document.getElementById("add1");

        addButton.addEventListener("click", async () => {
            const name = document.getElementById("name").value;
            const title = document.getElementById("title").value;
            const description = document.getElementById("description").value;

           
            const assign = document.getElementById("assign").value;
          

            const obj = {
                name: name,
                title: title,
                description:description,
              
                assign: assign,
              
            };
            console.log(obj)

            try {
                const response = await fetch("https://cute-puce-bluefish-garb.cyclic.app/post/add", {
                    method: "POST",
                    headers: {
                        'Content-type': 'application/json',
                        Authorization: `Bearer ${localStorage.getItem('token')}`
                    },
                    body: JSON.stringify(obj)
                })

              .then((res)=>{
                return res.json()

              })
              .then((res)=>{
                fetchData();
                console.log(res)
                alert("sucessfully created")
              })
            } catch (error) {
                console.error({"Error": error.message});
                alert('Error in Creating Task');
            }
        });

    

        const items = document.getElementById("items");

        function displayData(data) {
            items.innerHTML = "";
            data.forEach(element => {
                const card = document.createElement("div");
                card.innerHTML = `
                    <div id="taskmanager">
                        <h5>Task</h5>
                        <p>Name: ${element.name}</p>
                        <p>Title: ${element.title}</p>
                        <p>Description: ${element.description}</p>

                      
                        <p>Assign: ${element.assign}</p>
                        <p>Status: ${element.completed ? 'Completed' : 'Pending'}</p>
                <input type="checkbox" ${element.completed ? 'checked' : ''} id="completedCheckbox_${element._id}" onchange="updateCompletionStatus('${element._id}')">
                <button id="updateCompletionStatus" onclick="updateCompletionStatus('${element._id}')">${element.completed ? 'Undo Completion' : 'Mark as Complete'}</button>
                <button id="delete" onclick="deleteTask('${element._id}')">Delete</button>
                      
                  
                    </div>
                `;
                items.appendChild(card);
            });
        }


      async function updateCompletionStatus(taskId) {
    try {
        const response = await fetch(`https://cute-puce-bluefish-garb.cyclic.app/post/complete/${taskId}`, {
            method: 'PUT',
            headers: {
                'Content-type': 'application/json',
                Authorization: `Bearer ${localStorage.getItem('token')}`
            },
        });

        if (response.ok) {
            fetchData(); 
            alert('Task successfully created');
        } else {
            alert('Error updating task status');
        }
    } catch (error) {
        console.error(error);
        alert('Error updating task status');
    }
}





async function deleteTask(id) {
    try {
        const response = await fetch(`https://cute-puce-bluefish-garb.cyclic.app/post/delete/${id}`, {
            method: "DELETE",
            headers: {
                'Content-type': 'application/json',
                Authorization: `Bearer ${localStorage.getItem('token')}`
            },
        })
        .then((res)=>{
                return res.json()

              })
              .then((res)=>{
                fetchData();
                console.log(res)
                alert("sucessfully delete")
              })

     
    } catch (error) {
        console.error({"Error": error.message});
        alert('Error deleting task');
    }
}
















</script>